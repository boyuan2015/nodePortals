(function(e,a,h){var b={idDtRestaurants:"dt-restaurants",idPanelBodyRestaurants:"panelBodyRestaurants",classAExpand:"a-expand",classPlusIcon:"fa-plus-square-o",classMinusIcon:"fa-minus-square-o",classSpinnerIcon:"fa-spinner",classContainerDataTable:"container-data-table",classTrNoHover:"tr-no-hover",classBtnDeleteRestaurant:"btn-delete-restaurant",urlShowCompanyChildrenInline:"/company/{id}/children",urlDeleteRestaurant:"/restaurant/{id}",objSpinner:null,intSpinnerRemoveDelay:0,textConfirmationRequired:"Confirmation Required",textActionDescriptionBase:"Would you like to {0} this item '{1}'?",textMessageDelete:"Delete"};var d=function(i,k){if(e(i).length){var m=true;if(k!==h){m=k}b.objSpinner=VWUtility.createSpinner("."+b.classContainerDataTable);var l=e(i);var j=function(){l.find("."+b.classAExpand).off().on({click:function(){g(this,l)}});l.find("."+b.classBtnDeleteRestaurant).off().on({click:function(){var p=e(this);var o=p.data("restaurant-name");var n="<strong>Restaurant - "+b.textConfirmationRequired+"</strong><br />";bootbox.confirm(n+b.textActionDescriptionBase.format({0:b.textMessageDelete,1:o}),function(r){if(r){b.objLadda=Ladda.create(p.get(0));b.objLadda.start();var s=p.data("restaurant-id");var q=p.parents("tr");c(s,q)}})}})};l.dataTable({bFilter:m,bInfo:m,bPaginate:m,aaSorting:[[1,"asc"]],aoColumns:[{bSortable:false},null,null,{bSortable:false}],drawCallback:function(){j()},initComplete:function(o,n){setTimeout(function(){VWUtility.resetSpinner(b.objSpinner);e("."+b.classContainerDataTable).css("visibility","visible")},b.intSpinnerRemoveDelay)}})}else{e("."+b.classContainerDataTable).css("visibility","visible")}};var g=function(i,j){var k=e(i).parents("tr")[0];var l=e(k).data("id");if(j.fnIsOpen(k)){e(i).find("i").addClass(b.classPlusIcon);e(i).find("i").removeClass(b.classMinusIcon);j.fnClose(k)}else{e(i).find("i").addClass(b.classSpinnerIcon);e(i).find("i").removeClass(b.classPlusIcon);e.ajax({url:b.urlShowCompanyChildrenInline.replace("{id}",l.toString()),type:"GET",dataType:"html",data:{id:l},success:function(m){e(i).find("i").addClass(b.classMinusIcon);e(i).find("i").removeClass(b.classSpinnerIcon);j.fnOpen(k,m,"details");if(e(m).find("table").hasClass("dt-data")){d("#"+e(m).find("table").attr("id"),false)}},error:function(m){e(i).find("i").addClass(b.classPlusIcon);e(i).find("i").removeClass(b.classSpinnerIcon)}})}};var c=function(i,j){e.ajax({type:"POST",url:(b.urlDeleteRestaurant.replace("{id}",i)),data:{_method:"DELETE"},dataType:"json",success:function(k){if((k!=null)&&(k.success)){j.remove();VWUtility.showDismissibleAlert("#"+b.idPanelBodyRestaurants,VWUtility.getAlertTypes().ALERT_TYPE_SUCCESS,"Success:","Deleted the Restaurant.")}else{if(k!=null){VWUtility.showDismissibleAlert("#"+b.idPanelBodyRestaurants,VWUtility.getAlertTypes().ALERT_TYPE_DANGER,"Error:","Problem deleting Restaurant ("+k.status+").");VWUtility.resetLadda(b.objLadda)}}},error:function(){VWUtility.resetLadda(b.objLadda)}})};var f=function(){d("#"+b.idDtRestaurants)};f()}(jQuery,window.VWRestaurants=window.VWRestaurants||{}));
(function(d,c,h){var b={idDt:"dt-survey",idBtnSearch:"btnSearch",classAExpand:"a-expand",classPlusIcon:"fa-plus-square-o",classMinusIcon:"fa-minus-square-o",classSpinnerIcon:"fa-spinner",classContainerDataTable:"container-data-table",urlShowCompanyChildrenInline:"/survey/{id}/children",objSpinner:null,objLadda:null,intSpinnerRemoveDelay:1000,messageTitle:"<strong>Scheduled Survey</strong><br />"};var f=function(){d("#searchrange").val(moment().format("MM/DD/YYYY 00:00:00")+" - "+moment().add(1,"years").format("MM/DD/YYYY 00:00:00"));d("input:hidden[name='hidSearchRangeFrom']").val(moment().format("MM/DD/YYYY 00:00:00"));d("input:hidden[name='hidSearchRangeTo']").val(moment().add(1,"years").format("MM/DD/YYYY 00:00:00"));d("#searchrange").daterangepicker({startDate:moment().format("MM/DD/YYYY"),endDate:moment().add(1,"years").format("MM/DD/YYYY"),timePicker:true,timePicker12Hour:false,timePickerIncrement:10,format:"MM/DD/YYYY hh:mm:ss"});d("#searchrange").on("apply.daterangepicker",function(j,i){d("input:hidden[name='hidSearchRangeFrom']").val(i.startDate.format("MM/DD/YYYY hh:mm:ss"));d("input:hidden[name='hidSearchRangeTo']").val(i.endDate.format("MM/DD/YYYY hh:mm:ss"))});d("#btnSearch").on({click:function(){var j=d("input:hidden[name='hidSearchRangeFrom']").val();var i=d("input:hidden[name='hidSearchRangeTo']").val();location.href="/survey/schedule?from="+j+"&to="+i}})};var e=function(){b.objSpinner=VWUtility.createSpinner("."+b.classContainerDataTable);var i=d("#"+b.idDt);i.dataTable({dom:"<'row'<'col-xs-3'l><'col-xs-6'<'visual-search-container'>><'col-xs-3'f>r>t<'row'<'col-xs-6'i><'col-xs-6'p>>",aaSorting:[[1,"asc"]],aoColumns:[{bSortable:false},null,null,null,null,null,{bSortable:false}],initComplete:function(k,j){setTimeout(function(){VWUtility.resetSpinner(b.objSpinner);d("."+b.classContainerDataTable).css("visibility","visible")},b.intSpinnerRemoveDelay)}});d("#search-parameter-box").appendTo(d(".visual-search-container"));d("#search-parameter-box").removeClass("hidden");i.find("."+b.classAExpand).on({click:function(){a(this,i)}})};var a=function(i,j){var k=d(i).parents("tr")[0];var l=d(k).data("id");if(j.fnIsOpen(k)){d(i).find("i").addClass(b.classPlusIcon);d(i).find("i").removeClass(b.classMinusIcon);j.fnClose(k)}else{d(i).find("i").addClass(b.classSpinnerIcon);d(i).find("i").removeClass(b.classPlusIcon);d.ajax({url:b.urlShowCompanyChildrenInline.replace("{id}",l.toString()),type:"GET",dataType:"html",data:{id:l},success:function(m){d(i).find("i").addClass(b.classMinusIcon);d(i).find("i").removeClass(b.classSpinnerIcon);j.fnOpen(k,m,"details")},error:function(m){d(i).find("i").addClass(b.classPlusIcon);d(i).find("i").removeClass(b.classSpinnerIcon);console.log("error: "+m)}})}};c.deleteSurvey=function(l,k,i){var j=this;bootbox.confirm(b.messageTitle+'Would you like to delete scheduled survey "'+k+'" ?',function(m){if(m){$btn=d(i);b.objLadda=Ladda.create($btn.get(0));b.objLadda.start();d.ajax({url:"/survey/"+l+"/destroySchedule",success:function(n){if(n.indexOf("error")===-1){VWUtility.resetLadda(b.objLadda);location.href="/survey/schedule?status=deleted"}else{VWUtility.resetLadda(b.objLadda);console.log(n)}}})}})};var g=function(){e();f()};g()}(jQuery,window.VWSurveySchedules=window.VWSurveySchedules||{}));
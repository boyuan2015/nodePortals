$().ready(function(){var c={idPanelBodySearch:"panelBodySearch",idButtonSearch:"btnSearch",idFrmSearch:"frmSearch",classLaddaBtn:"ladda-button",urlPaymentSearch:"/payment/search"};var l=function(){VWUtility.bindAutoLadda();console.log("dataTableDrawCallback")};var e=$("#dt-transaction");e.dataTable({aaSorting:[[1,"asc"]],aoColumns:[null,null,null,null,null,{bSortable:false}],dom:'T<"clear-both">lfrtip',tableTools:{sSwfPath:"/assets/plugins/datatables/extensions/TableTools/swf/copy_csv_xls_pdf.swf",aButtons:["copy","csv","pdf","print"]},columnDefs:[{render:function(n,m,o){return'<a href="/transaction/'+n+"?"+o[o.length-1]+'" class="btn btn-default btn-xs btn-ladda-auto ladda-button" data-style="contract">View</a>'},targets:5},{"class":"text-center",targets:5}],drawCallback:function(){l()}});var h=function(m){$("#"+c.idFrmSearch).validate({submitHandler:function(p,o){o.preventDefault();var n=Ladda.create(m.get(0));n.start();var r=$("input:radio[name='radSearchBy']:checked").val();var u=$("input:text[name='txtSearchParameter']").val();var t=$("input:hidden[name='hidSearchRangeFrom']").val();var s=$("input:hidden[name='hidSearchRangeTo']").val();var q="type="+r+"&parameter="+u+"&dateFrom="+t+"&dateTo="+s;$.ajax({url:c.urlPaymentSearch,type:"POST",dataType:"html",data:{type:r,parameter:u,dateFrom:t,dateTo:s},success:function(x){var w=jQuery.parseJSON(x);if(w.success){VWUtility.showDismissibleAlert("#"+c.idPanelBodySearch,VWUtility.getAlertTypes().ALERT_TYPE_SUCCESS,"Success:","Your search completed.");$("#transactionCount").text(w.data.length);e.fnClearTable();if(w.data.length>0){for(var v=0;v<w.data.length;v++){w.data[v][w.data[v].length]=q}e.fnAddData(w.data);e.fnDraw()}}else{VWUtility.showDismissibleAlert("#"+c.idPanelBodySearch,VWUtility.getAlertTypes().ALERT_TYPE_WARNING,"Error:",w.status)}},error:function(v){VWUtility.showDismissibleAlert("#"+c.idPanelBodySearch,VWUtility.getAlertTypes().ALERT_TYPE_WARNING,"Error:",v.responseText)}}).always(function(){VWUtility.resetLadda(n)})}})};$("#btnSearch").on({click:function(){h($(this))}});$("input:radio[name='radSearchBy']").click(function(){a($(this).val())});var a=function(m){switch(m){case"DateRange":$("#txtSearchParameter").prop("required",false);$("#lblSearchValue").hide();$("#divSearchValue").hide();$("#txtSearchParameter-error").hide();break;default:$("#txtSearchParameter").prop("required",true);$("#lblSearchValue").show();$("#divSearchValue").show();$("#txtSearchParameter-error").show();break}};$("input:text[name='txtSearchParameter']").keypress(function(m){if(m.which==13){$("#btnSearch").click()}});var k=function(m){m=m.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp("[\\?&]"+m+"=([^&#]*)"),n=o.exec(location.search);return n==null?"":decodeURIComponent(n[1].replace(/\+/g," "))};var b="";var d="";if(k("type")!=""){var g=k("type");var i=k("parameter");var f=k("dateFrom");var j=k("dateTo");$("input[name=radSearchBy][value="+g+"]").attr("checked","checked");$("input:text[name='txtSearchParameter']").val(i);$("#DateRange").prop("checked",true);a(g);$("#searchrange").val(f+" - "+j);$("input:hidden[name='hidSearchRangeFrom']").val(f);$("input:hidden[name='hidSearchRangeTo']").val(j);b=f;d=j;$("#btnSearch").click()}else{b=moment().subtract(1,"days").format("MM/DD/YYYY 00:00:00");d=moment().format("MM/DD/YYYY 00:00:00");$("#searchrange").val(b+" - "+d);$("input:hidden[name='hidSearchRangeFrom']").val(b);$("input:hidden[name='hidSearchRangeTo']").val(d)}$("#searchrange").daterangepicker({startDate:b,endDate:d,timePicker:true,timePicker12Hour:false,timePickerIncrement:10,format:"MM/DD/YYYY hh:mm:ss"});$("#searchrange").on("apply.daterangepicker",function(n,m){console.log("apply.daterangepicker : "+m.startDate);$("input:hidden[name='hidSearchRangeFrom']").val(m.startDate.format("MM/DD/YYYY HH:mm:ss"));$("input:hidden[name='hidSearchRangeTo']").val(m.endDate.format("MM/DD/YYYY HH:mm:ss"))})});
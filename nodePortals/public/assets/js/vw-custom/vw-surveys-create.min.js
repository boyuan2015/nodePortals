(function(f,h,c){var e={idFormCreate:"frmAddQuestion",idBtnCreate:"btnAddQuestion",idBtnNext:"btnGotoStep2",objLadda:null};var i=function(){var o=f(":input");var l=[];for(var m=0;m<o.length;m++){var n=o[m];if(n.id!=c&&n.id.indexOf("txtQuestionChoice")!=-1&&n.id.indexOf("-error")==-1){l.push(n)}}return l};var b=function(){var l=i();var p=[];for(var n=0;n<l.length;n++){var m=l[n];var o=f(m).val();if(o!=""){p.push(o)}}return p};var d=function(){f.validator.addMethod("validateNumberOfChoices",function(m,l){var n=b();if(n.length<2){return false}return true},"Require at least 2 choices");f.validator.addMethod("validateDuplicatedOfChoices",function(o,n){var p=b();var l=p.sort();for(var m=0;m<l.length-1;m++){if(l[m+1]==l[m]){return false}}return true},"There are some duplicated choices")};var j=function(){d();f("#"+e.idBtnCreate).click(function(){var p=f(this);var m=i();var l={};for(var o=0;o<m.length;o++){var n=m[o];l[n.id]={validateNumberOfChoices:true}}f("#"+e.idFormCreate).validate({rules:l,submitHandler:function(r){var s=f("#txtQuestionText").val();var q=f("#selQuestionType").val();var t=b();a(r,s,q,t)}})})};var g=function(){VWSurveys.setCurrentStep(0);VWSurveys.setupComponents()};var a=function(o,p,m,q){var n=f("#"+e.idBtnCreate);e.objLadda=Ladda.create(n.get(0));e.objLadda.start();var l={success:function(r){if((r!=null)&&(r.toLowerCase().indexOf("error")===-1)){h.addQuestionToList(p,m,q);VWUtility.resetLadda(e.objLadda);VWUtility.showDismissibleAlert("#panel-body",VWUtility.getAlertTypes().ALERT_TYPE_SUCCESS,"Success:","Added a new Question.")}else{if(r!=null){VWUtility.resetLadda(e.objLadda);VWUtility.showDismissibleAlert("#panel-body",VWUtility.getAlertTypes().ALERT_TYPE_DANGER,"Error:","Could not add a new Question.");console.log("Error #1")}}},error:function(){VWUtility.resetLadda(e.objLadda);VWUtility.showDismissibleAlert("#panel-body",VWUtility.getAlertTypes().ALERT_TYPE_DANGER,"Error:","Could not add a new Question.");console.log("Error #2")}};f(o).ajaxSubmit(l)};h.onBtnStep2Click=function(){if(f("#accordioninPanelAddQuestion").children().length==0){VWUtility.showDismissibleAlert("#panel-body",VWUtility.getAlertTypes().ALERT_TYPE_DANGER,"Error:","Require at least 1 question");return}var l=f("#"+e.idBtnNext);e.objLadda=Ladda.create(l.get(0));e.objLadda.start();window.location.href="/survey/create?step=2"};h.onAddAnotherQuestionClick=function(){f("#aAddAnotherQuestion").hide();f("#divAddAnotherQuestion").show("blind",300)};h.onAddAnotherChoiceClick=function(){var r=i();var n=1;var p=0;for(var m=0;m<r.length;m++){var l=r[m];var q=parseInt(l.id.replace("txtQuestionChoice",""));if(q>p){p=q}}n+=p;var o="";if(n<=2){o='<div class="input-group"><input type="text" class="form-control" style="width: 418px" id="txtQuestionChoice'+n+'" name="txtQuestionChoice'+n+'" placeholder="choice '+n+'"></div>'}else{o='<div class="input-group" id="divChoice'+n+'"><input type="text" class="form-control" id="txtQuestionChoice'+n+'" name="txtQuestionChoice'+n+'" placeholder="choice '+n+'"><span class="input-group-btn" style="vertical-align: top;"><button class="btn btn-default btn-delete-rf-id-tag vw-tooltip" type="button" data-toggle="tooltip" data-placement="top" title="Delete this choice" data-rf-id="3" onclick="VWSurveyCreate.removeChoice('+n+')"><i class="fa fa-times"></i></button></span></div>'}f("#divChoices").append(o)};h.removeChoice=function(l){f("#divChoice"+l).remove()};h.resetAddAnotherQuestionView=function(){f("#txtQuestionText").val("");f("#selQuestionType").val("RADIO");f("#divChoices").empty();f("#aAddMoreChoice").show();h.onAddAnotherChoiceClick();h.onAddAnotherChoiceClick();f("#aAddAnotherQuestion").show("blind",300);f("#divAddAnotherQuestion").hide("blind",300)};h.addQuestionToList=function(o,n,q){var p='<div class="col-sm-6">';q.forEach(function(r){p+='<label class="radio-inline">'+r+"</label><br/>"});p+="</div>";var l=f("#accordioninPanelAddQuestion").children().length+1;var m='<div class="accordion-item collapse.in">';m+='    <a class="accordion-title" data-toggle="collapse" data-parent="#accordioninPanelAddQuestion" href="#collapseinDemoQuestion'+l+'"><h4>'+o+"</h4></a>";m+='    <div id="collapseinDemoQuestion'+l+'" class="collapse">';m+='        <div class="accordion-body">';m+='            <div class="form-group">';m+=p;m+="            </div>";m+="        </div>";m+="    </div>";m+="</div>";f("#accordioninPanelAddQuestion").append(m);h.resetAddAnotherQuestionView()};var k=function(){j();if(f("#accordioninPanelAddQuestion").children().length==0){f("#aAddAnotherQuestion").hide();f("#divAddAnotherQuestion").show()}else{f("#aAddAnotherQuestion").show();f("#divAddAnotherQuestion").hide()}g();f("svg").height(100)};k()}(jQuery,window.VWSurveyCreate=window.VWSurveyCreate||{}));